title: USB Device Insertion Followed by Suspicious Activity
id: 3b4c5d6e-7f8a-9b0c-1d2e-3f4a5b6c7d8e
status: experimental
description: |
    Detects USB device insertion followed by suspicious process execution.
    In the BOTSV1 scenario, Bob Smith found a USB drive labeled "MIRANDA_PRI"
    in the parking lot and plugged it into his workstation (we8105desk).

    Attack Chain:
    1. USB device "MIRANDA_PRI" inserted
    2. User opens Miranda_Tate_unveiled.dotm from D:\ drive
    3. Malicious macro executes, spawning wscript.exe

    Social Engineering: The USB and document names reference "Miranda Tate"
    (a character from The Dark Knight Rises - Wayne Enterprises theme)
references:
    - https://github.com/splunk/botsv1
    - https://www.aldeid.com/wiki/TryHackMe-BP-Splunk/Ransomware
author: Tyler Casey
date: 2024/01/28
tags:
    - attack.initial_access
    - attack.t1091
logsource:
    category: driver_load
    product: windows
detection:
    usb_insertion:
        EventCode: 7045
        Service_Name|contains:
            - 'USB'
            - 'USBSTOR'
            - 'MIRANDA_PRI'
    suspicious_process:
        EventCode: 1
        Image|endswith: '\WINWORD.EXE'
    timeframe: 5m
    condition: usb_insertion followed by suspicious_process
falsepositives:
    - Legitimate USB device usage
level: medium
