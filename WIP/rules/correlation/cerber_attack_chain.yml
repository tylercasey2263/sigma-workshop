title: Cerber Ransomware Attack Chain Correlation
id: 9b0c1d2e-3f4a-5b6c-7d8e-9f0a1b2c3d4e
status: experimental
description: |
    Correlates multiple events to detect the complete Cerber ransomware infection chain.
    Observing the progression from macro execution → VBScript → payload download → encryption
    confirms a successful ransomware infection.

    BOTSV1 Timeline (August 24, 2016):
    - 16:43:12 UTC: Bob Smith opens Miranda_Tate_unveiled.dotm from USB (MIRANDA_PRI)
    - 16:43:XX UTC: Word macro spawns wscript.exe
    - 16:48:12 UTC: DNS query to solidaritedeproximite.org
    - 16:48:13 UTC: Download of mhtr.jpg (steganography payload)
    - 16:48:21 UTC: Execution of 121214.tmp
    - 17:15:12 UTC: DNS query to cerberhhyed5frqa.xmfir0.win (C2)
    - 17:XX:XX UTC: Mass file encryption begins

    Total time from document open to encryption: ~30 minutes

    Patient Zero: we8105desk (192.168.250.100) - Bob Smith
    File Server Victim: we9041srv (192.168.250.20)
references:
    - https://github.com/splunk/botsv1
    - https://www.aldeid.com/wiki/TryHackMe-BP-Splunk/Ransomware
author: Tyler Casey
date: 2024/01/28
tags:
    - attack.initial_access
    - attack.t1091
    - attack.execution
    - attack.t1204.002
    - attack.command_and_control
    - attack.t1105
    - attack.impact
    - attack.t1486
correlation:
    type: temporal
    rules:
        - 6a7b8c9d-0e1f-2a3b-4c5d-6e7f8a9b0c1d  # Office macro execution
        - 7b8c9d0e-1f2a-3b4c-5d6e-7f8a9b0c1d2e  # VBScript execution
        - 9d0e1f2a-3b4c-5d6e-7f8a-9b0c1d2e3f4a  # Payload download
        - 1f2a3b4c-5d6e-7f8a-9b0c-1d2e3f4a5b6c  # Mass file encryption
    timeframe: 1h
    ordered: true
level: critical
