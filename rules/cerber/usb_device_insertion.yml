title: USB Device Insertion Followed by Suspicious Activity
id: 3b4c5d6e-7f8a-9b0c-1d2e-3f4a5b6c7d8e
status: experimental
description: Detects USB device insertion followed by suspicious process execution
references:
    - https://github.com/splunk/botsv1
author: Tyler Casey
date: 2024/01/28
tags:
    - attack.initial_access
    - attack.t1091
logsource:
    category: driver_load
    product: windows
detection:
    usb_insertion:
        EventCode: 7045
        Service_Name|contains:
            - 'USB'
            - 'USBSTOR'
    suspicious_process:
        EventCode: 1
        Image|endswith: '\WINWORD.EXE'
    timeframe: 5m
    condition: usb_insertion followed by suspicious_process
falsepositives:
    - Legitimate USB device usage
level: medium
